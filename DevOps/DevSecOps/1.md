# ğŸ“Œ DevOps ve GÃ¼venlik

YazÄ±lÄ±m geliÅŸtirme sÃ¼reÃ§lerinde, gÃ¼venlik Ã¶nemli bir kriterdir. DevOps sÃ¼reÃ§leri/KÃ¼ltÃ¼rÃ¼, yazÄ±lÄ±m geliÅŸtirme ve operasyonel ekiplerinin bir araya getirerek yazÄ±lÄ±m sÃ¼reÃ§lerinin hÄ±zlandÄ±rmaktadÄ±r. Ancak artan siber gÃ¼venlik zafiyetleri/saldÄ±rÄ±larÄ±, DevSecOps yaklaÅŸÄ±mÄ±nÄ± gÃ¼ndeme taÅŸÄ±mÄ±ÅŸtÄ±r. DevSecOps, gÃ¼venliÄŸin en baÅŸÄ±ndan itibaren dail edilmesi anlamÄ±na gelmektedir.

![](/img/SecOps.jpg)

Kritik altyapÄ±lara yÃ¶nelik siber gÃ¼venlik saldÄ±rÄ±larÄ± sÄ±radan hale geldi. Bir gÃ¼venlik aÃ§Ä±ÄŸÄ± bile milyonlarca kullanÄ±cÄ±yÄ± ektileyebilir. Ã–rneÄŸin, yanlÄ±ÅŸ yapÄ±landÄ±rÄ±lmÄ±ÅŸ bir API, kullanÄ±cÄ± verilerinin Ã§alÄ±nmasÄ±na yol aÃ§abilir. Bu nedenle ÅŸirkeler sadece â€œdaha hÄ±zlÄ± geliÅŸtirmekâ€ yerine artÄ±k â€œdaha gÃ¼venli geliÅŸtirmeyeâ€ odaklanmaktadÄ±r.

**Neden DevSecOps?**

Geleneksel yazÄ±lÄ±m geliÅŸtirme modelinde gÃ¼venlik, yazÄ±lÄ±m sÃ¼rÃ¼m Ã§Ä±kÄ±lmadan hemen Ã¶nce devreye girmektedir. Bu durum gÃ¼venlik aÃ§Ä±klarÄ±nÄ±n geÃ§ fark edilmesine ve maliyetlerin artmasÄ±na yol aÃ§maktadÄ±r. DevSecOps yaklaÅŸÄ±mÄ±yla;

* Kod geliÅŸtirme aÅŸamasÄ±nda gÃ¼venlik kontrolleri yapÄ±lÄ±r.
* CI/CD pipeline iÃ§ine otomatik gÃ¼venlik taramalarÄ± entegre edilir.
* Hatalar hÄ±zlÄ± geri bildirimle dÃ¼zeltilir.

**ğŸ”¹ Golang Ã¶rneÄŸi â€“ kÃ¶tÃ¼ uygulama:**


```go
// Hassas veriyi loglamak -> kÃ¶tÃ¼ uygulama
log.Printf("User login attempt with password: %s", password)
```
**ğŸ”¹ DoÄŸru uygulama:**
```golang
// GÃ¼venli loglama -> hassas veri yazÄ±lmaz
log.Println("User login attempt detected")
```
Bu tarz kontroller otomatik CI/CD sÃ¼recinde yakalanabilir.

----------------------------------------------------------------------------------------------------

## API GÃ¼venliÄŸi

API'ler, modern yazÄ±lÄ±m geliÅŸtirme sÃ¼reÃ§lerinden Ã¶nemli bir yapÄ± taÅŸÄ±dÄ±r. Basit bir login endpoint dÃ¼ÅŸÃ¼nelim;
```go
// âŒ Kimlik doÄŸrulama ve rate limit yok
r.POST("/login", func(c *gin.Context) {
    var creds Credentials
    if err := c.BindJSON(&creds); err != nil {
        c.JSON(http.StatusBadRequest, gin.H{"error": "invalid request"})
        return
    }
    c.JSON(http.StatusOK, gin.H{"status": "login success"})
})
```
Bu endpoint saldÄ±rÄ±ya aÃ§Ä±ktÄ±r. DevSecOps yaklaÅŸÄ±mÄ±yla ÅŸunlar yapÄ±labilir;

âœ… JWT tabanlÄ± kimlik doÄŸrulama
âœ… Rate limiting ile brute-force engelleme
âœ… Input validation

Bu iÅŸlemler iÃ§in aÅŸaÄŸÄ±daki gibi Ã¶rnek kod bloglarÄ± kullanÄ±labilir;

**Input Validation**
```go
type LoginReq struct {
    Email    string `json:"email" binding:"required,email"`
    Password string `json:"password" binding:"required,min=8"`
}

r.POST("/login", func(c *gin.Context) {
    var req LoginReq
    if err := c.ShouldBindJSON(&req); err != nil {
        c.JSON(http.StatusBadRequest, gin.H{"error": "invalid input"})
        return
    }
    c.JSON(http.StatusOK, gin.H{"status": "valid input"})
})

```
Bu Ã¶rnekte ``binding:"required,email"`` gibi tagâ€™ler ile zorunluluk ve format kontrolÃ¼ yapÄ±yoruz.

**JWT Kimlik DoÄŸrulama**
```go
import "github.com/golang-jwt/jwt/v5"

secret := []byte("mysecret")

r.POST("/login", func(c *gin.Context) {
    // normalde burada kullanÄ±cÄ± doÄŸrulama yapÄ±lÄ±r
    token := jwt.NewWithClaims(jwt.SigningMethodHS256, jwt.MapClaims{
        "sub": "user123",
        "exp": time.Now().Add(15 * time.Minute).Unix(),
    })
    signed, _ := token.SignedString(secret)
    c.JSON(200, gin.H{"token": signed})
})

auth := r.Group("/api")
auth.Use(func(c *gin.Context) {
    t := c.GetHeader("Authorization")[7:]
    parsed, _ := jwt.Parse(t, func(*jwt.Token) (interface{}, error) {
        return secret, nil
    })
    if parsed == nil || !parsed.Valid {
        c.AbortWithStatusJSON(401, gin.H{"error": "invalid token"})
        return
    }
    c.Next()
})

auth.GET("/profile", func(c *gin.Context) {
    c.JSON(200, gin.H{"message": "protected ok"})
})
```
``/login`` endpointâ€™inde JWT Ã¼ret, ``Authorization: Bearer <token>`` ile istek gÃ¶nderildiÄŸinde middleware doÄŸrular.

**Rate Limiting**

```go
import "golang.org/x/time/rate"

limiter := rate.NewLimiter(1, 3) // saniyede 1 istek, burst=3

r.Use(func(c *gin.Context) {
    if !limiter.Allow() {
        c.AbortWithStatusJSON(429, gin.H{"error": "too many requests"})
        return
    }
    c.Next()
})
```
AynÄ± anda en fazla 3 burst, ardÄ±ndan saniyede 1 istek izin veriliyor.


Ã–rnek rate limiting middleware:
```go
import "golang.org/x/time/rate"

limiter := rate.NewLimiter(1, 3) // saniyede 1 istek, burst=3
r.Use(func(c *gin.Context) {
    if !limiter.Allow() {
        c.AbortWithStatusJSON(http.StatusTooManyRequests, gin.H{"error": "too many requests"})
        return
    }
    c.Next()
})
```

## CI/CD Pipeline + Go UygulamalarÄ± + GÃ¼venlik TaramasÄ±

DevSecOps mantÄ±ÄŸÄ± CI/CD sÃ¼reÃ§lerine entegtre edilebilir. Entegre iÅŸlemleri aÅŸaÄŸÄ±daki adÄ±mlar izlenir;

1. Kodun alÄ±nmasÄ± (checkout)
2. Go build ve test Ã§alÄ±ÅŸtÄ±rma
3. Statik gÃ¼venlik taramasÄ± (gosec)
4. Container image oluÅŸturma
5. Container image Ã¼zerinde gÃ¼venlik taramasÄ± (Trivy gibi)
6. Deployment

**ğŸ”¹ GitHub Actions Ã¶rneÄŸi:**

```yaml
name: Go CI/CD with Security

on: [push, pull_request]

jobs:
  build-and-scan:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up Go
        uses: actions/setup-go@v4
        with:
          go-version: '1.22'

      - name: Build
        run: go build ./...

      - name: Run tests
        run: go test ./...

      - name: Run gosec (Static Security Analysis)
        run: go install github.com/securego/gosec/v2/cmd/gosec@latest && gosec ./...

      - name: Build Docker image
        run: docker build -t myapp:latest .

      - name: Trivy Scan (Docker Image Security)
        uses: aquasecurity/trivy-action@master
        with:
          image-ref: 'myapp:latest'
          format: 'table'

```
Bu pipelineâ€™da:

* gosec â†’ Golang kodunda gÃ¼venlik aÃ§Ä±klarÄ±nÄ± analiz eder.
* Trivy â†’ Docker imajÄ±ndaki zafiyetleri tarar.
* Testler â†’ Hem fonksiyonel hem de gÃ¼venlik kontrollerinin sÃ¼rekliliÄŸini saÄŸlar.

SonuÃ§ta yazÄ±lÄ±m sadece hÄ±zlÄ± deÄŸil, aynÄ± zamanda gÃ¼venli bir ÅŸekilde devreye alÄ±nÄ±r.
